---
layout: post
title:  "통계 공부 추정"
date:   2023-03-13 15:00:00 +0900
comments: true
categories: statistics
tags: [추정,가설검정]
keywords: [통계]
image: /assets/images/posts/common/25673_21329_0.jpg
excerpt_separator: <!--more-->
---

# 추정
## 추정
--- 
- 정의
	- 추정 : 모집단의 모수를 모를 경우 표본으로 추출된 통계량을 모집단의 근사값으로 사용하는것
	- 추정량 : 표본 평균으로 모평균을 추정할 때 표본 평균을 모평균에 대한 추정량이라고 함
- 추정 방법
	- 점추정 : 모수 하나의 특정값으로 추정하는 방법
	- 구간추정 : 모수가 포함될 수 있는 구간을 추정하는 방법
### 점 추정
- 성질
	- 일치성(Consistency)
		- 표본의 크기가 모집단의 크기에 근접해야 함.
		- 표본이 크기가 크면 클수록(모집단에 가까울수록) 추정량의 오차가 작아짐.
	- 불편성(unbiased estimator)
		- 추정량이 모수와 같아야 함
		- 모수가 $\theta$ 이고 추정량이 $\widehat{\theta}$이라고 정의하면, $E[\widehat{\theta}]=0$ 이고 이를 불편추정량이라고 함.
		- 같지 않다면 편의(biased)가 있다고 함.
	- 유효성 (efficiency)
		- 추정량의 분산이 최소값이어야 함
		- 모수에 대한 추정량의 분산이 작을 수록 추정량이 효율적이라는 의미
		- 만약 모수 $\theta$의 불편추정량이 $\widehat{\theta_1},\widehat{\theta_1}$이고 $\widehat{\theta_{1}}< \widehat{\theta_2}$  라면 $\widehat{\theta_1}$이 효율적인 추정량임
	- 평균오차제곱 (Mean Squared Error : MSE)
		- $E[(\widehat{\theta}-\theta)^2]$이 최소여야 함

### 구간추정
#### 1. 모집단 평균, 모집단 비율의 구간추정

##### 모집단 평균과 비율의 성질
- 신뢰구간(confidence level)
	- 추정값이 존재하는 구간에 모수가 포함될 확률
	- 신뢰 수준은 $100 \times (1-a)$%로 계산되며 $a$는 오차 수준임
	- 신뢰 수준 95%라는것은 구간 추정된 값의 오차가 발생할 확률이 5%라는 것을 의미함
	- 이 오차를 유의수준(significant level)이라고 하며 p=0.05라고 함
	- 신뢰 구간은 신뢰 하한, 신뢰 상한으로 표시하며 아래와 같은 수식으로 표현 (추정하는 모수가 $\theta$)
		- $P[L(\theta) \leq 0 \leq U(\widehat{\theta})]=1-a$ 

##### 모집단 평균과 비율의 신뢰구간 결정요인과 방법
- 신뢰구간 결정요인과 방법
	- ![500](https://i.imgur.com/C9R0K9S.jpg)
	1. 추출된 표본의 평균$(\overline{x})$를 구함
	2. 표본평균 $(\overline{x})$의 표준편차 값을 산출함 (표준오차 : 보폭)
	3. 신뢰수준 $(1-a)$에 따른 t값을 구함 (t값 걸음의 수)
	4. 표본평균 $(\overline{x})$을 중심으로 표준오차(보폭)와 t값(걸음의 수)을 곱한 값 만큼 좌우로 떨어진 값으로 이루어진 구간이 신뢰구간이 됨.

##### 모집단의 평균, 비율 추정 공식
- $\overline{x} - z*sd \leq \mu \leq \overline{x} + z*sd$
	- 모집단 평균 추정시 신뢰 구간
		- $\mu \in \overline{x} \pm t_{(\dfrac{a}{2},n-1)} \dfrac{S}{\sqrt{n}}$      $= \left[\overline{x}-t_{(\dfrac{a}{2},n-1)}\dfrac{S}{\sqrt{n}},\overline{x}+t_{(\dfrac{a}{2},n-1)}\dfrac{S}{\sqrt{n}}\right]$
	- 모집단 비율 추정시 신뢰구간 
	  *(평균과 비율 구간추정 방법은 같음. 표본평균의 표준편차를 표본비율의 표준편차로 바꾸면 된다.)*
		-  $\pi \in p \pm t_{(\dfrac{a}{2},n-1)} \sqrt{\dfrac{p(1-p)}{n}}$
##### 모집단의 평균 추정 예제
- 예제
	- 1) 표본 평균이 50, 표본표준편차가 10이라고 하자. 신뢰구간 95%에서 평균을 추정하면?
		- 표준정규분포표상, 0.95의 z값은 1.96
		- $\therefore 50\pm1.96$
	- 2) 모집단의 분산을 아는경우)
		- 모집단의 분산이 4, 표본평균이 10, 표본의 크기가 25라면 평균의 95% 신뢰구간은?
			- 표준정규분포 이용 해설. 95%의 z = 1.96
			- $10\pm 1.96 \times \frac{2}{5}$
	- 3) 모집단의 분산을 모르는 경우
		- 표본 분산이 4, 표본평균이 10, 표본의 크기가 25라면 평균의 95% 신뢰구간은?
			- t분포 이용 해설
			- $10\pm t_{0.025,24} \times \frac{2}{\sqrt(25)}$
			- $\therefore \mu \in [9.174,10.826]$

#### 2. 모집단분산의 구간추정

##### 모집단분산의 특이점
- 표본분산은 표본평균, 비율과 달리 정규분포하지 않는다.
	- 일반적으로 표본의 카이자승분포를 이용하여 수행한다.
- 카이제곱분포는 t분포와 달리 좌우대칭이 아니기에, 모집단평균과의 공식이 조금 다르다.
	- 카이제곱분포의 신뢰수준과 신뢰구간
		- ![](https://i.imgur.com/I3xPXug.png)
##### 모집단분산에 대한 신뢰구간 공식
- $$\sigma^{2} \in \left[\dfrac{(n-1)S^2}{X^2_{(\dfrac{a}{2},n-1)}},\dfrac{(n-1)S^2}{X^2_{(1-\dfrac{a}{2},n-1)}}\right] $$
![](https://i.imgur.com/wZfHzZ4.jpg)

##### 모집단 분산 구간추정 예제
- 예제1)
	- 문제
		- 품질관리팀에서 20개의 마취제를 임의로 추출하여 임상실험을 진행했다. 마취제 지속시간의 분산은 $90^2$ 분이었다. 이 조사를 바탕으로 마취제의 분산이 존재하리라 95% 신뢰할 수 있는 신뢰구간을 추정하라.
	- 풀이
		- $\dfrac{(n-1)S^2}{X^{2}_{(\dfrac{a}{2},(n-1))}},\dfrac{(n-1)S^2}{X^{2}_{(1-\dfrac{a}{2},(n-1))}}$
		- $\dfrac{(19)90}{X^{2}_{(0.025,19)}},\dfrac{(19)90}{X^{2}_{(0.975,19)}}$
		- $\sigma^{2}\in [52.05,191,91]$

### 표본의 크기
##### 표본 크기 설정의 의의
- 추정의 정확도와 조사비용은 trade-off 관계에 있다. 따라서 추정의 목적 및 조사 여건 상황을 고려해 적절한 수로 표본의 크기를 결정해야 한다.
- 표본 크기를 결정하는 요인은 최대허용오차$(e)$와 신뢰수준이 있다. 
	- (허용오차$(e)$와 허용오차수준($a$)은 다르다. 허용오차는 실제 오차를 뜻함.)
##### 표본 크기 결정식
- 표본 크기 결정 알고리즘
	- 적절한 표본의 크기$(n)$를 결정하기 위해서는 신뢰수준과 최대허용오차의 크기의 정보가 필요하다.
		- 왜냐하면,
		- 신뢰구간과 최대허용오차$(e)$는 신뢰수준$(1-a)$과 비례. 표본 크기$(n)$과는 반비례한다.
		- 즉, 신뢰구간의 크기를 고정한 상태에서 신뢰수준을 높이고자 한다면 표준오차(표본평균의 표준편차)의 크기를 줄여야 한다.
		- 표준오차를 줄이기 위해서는 표본의 크기를 늘려야 한다.
	- 그러나 최대허용오차$(e)$와 신뢰수준$(1-a)$은 과거경험등으로 적절히 결정된다.
	- 아래의 표본의 크기(n)을 구하는 식은 아래의 한계점이 있다.
		- 자유도에 따라 모양이 변하는 t분포 대신 상응하는 Z값을 이용한다.
		- 모집단의 분산이나 표본의 분산이 필요하다.
		- 단 표본의 크기를 정하는 과정에서 위의 정보를 알 수는 없다.
	- 그렇기에 2가지 방법으로 갈린다.
		1. 경험치를 이용한다.
		2. 모집단이 정규분포한다는 가정하여 아래의 방식을 따른다.
			1. 모집단에서 소수의 표본을 추출한다.
			2. 최대값가 최소값의 차이를 6개의 표준편차$(6\sigma)$로 간주한다.
			3. 최댓값과 최소값의 차이를 6으로 나눈 값을 표준편차로 사용한다.
- 표본 크기 공식 (e = 허용오차). 
  평균추정이나 비율추정을 이항하여 n값을 구하면 된다.
	- 평균추정에서의 표본크기$(n)$
		- $n = \dfrac{\left(t_{\frac{a}{2},n-1}\right)^2S^2}{e^{2}}= \dfrac{\left(Z_\frac{a}{2}\right)^2S^2}{e^2}$
	- 비율추정에서의 표본크기(n)
		- $n = \dfrac{\left(t_{\frac{a}{2},n-1}\right)^2p(1-p)}{e^{2}}= \dfrac{\left(Z_\frac{a}{2}\right)^2p(1-p)}{e^2}$
###### 모평균 차이의 추정
![](https://i.imgur.com/Krwud93.png)
- 모평균 차이 추정 절차 및 공식 (모비율 차이 추정의 경우 $s_n^2 ⇒ p(1-p)$)
	1. 표본들의 표준오차  공식 (SE = Standard Error)
		- 분산이 같다고 가정할 시
			- $SE(\overline{x}_1 - \overline{x}_2) = \sqrt{\dfrac{s_1^2}{n_1} + \dfrac{s_2^2}{n_2}}$
		- 분산이 다른것을 알고 있을 시, 합동 분산 추정량(pooled variance estimator)을 구하고, SE 공식에 대입하여 구한다.
			- $s^2(pooled) = \dfrac{(n_1-1)s_1^2 + (n_2-1) ^2s_2^2}{n_1 -1 + n_2 -1}$
			- $SE(\overline{x}_1 - \overline{x}_2) = \sqrt{\dfrac{s^2}{n_1} + \dfrac{s^2}{n_2}}$
	1. 점 추정치와 표준 오차가 있으면 지정된 신뢰 수준(예: 95%)으로 실제 모집단 평균 차이에 대한 신뢰 구간을 구성할 수 있습니다. 신뢰 구간의 공식은 다음과 같습니다.
		- $\overline{x}_1 - \overline{x}_2 \pm t_{\alpha/2, df} SE(\overline{x}_1 - \overline{x}_2)$
			- $df = n_1 + n_2 - 2$, 
	2. 이 공식은 실제 모집단 평균 차이에 대한 타당한 값의 범위를 제공하며, 점 추정치는 중앙에 있고 오차 한계는 t-점수와 표준 오차로 결정됩니다. 신뢰 구간에 0이 포함되지 않으면 두 모집단 평균 간의 차이가 지정된 신뢰 수준에서 통계적으로 유의하다는 결론을 내릴 수 있습니다. 신뢰 구간에 0이 포함되어 있으면 모집단 평균 간에 차이가 없다는 귀무 가설을 기각할 수 없습니다.
- 모평균 차이 추정 예제
	- 문제 1)
		- 한 기업의 남성과 여성의 평균 임금 차이를 95% 신뢰도로 추정하자. 각각 50, 60명씩 랜덤 샘플을 추출했으며, 남성의 평균 임금은 $65,000, 표준편차 $8,000. 여성의 평균 임금은 $60,000, 표준편차 $60,000, 표준편차 $7,000.
	- 해설 1)
		- SE를 구한다.
			- 분산이 동일하다고 가정할 시
				- $SE(\overline{x}_1-\overline{x}_1) = \sqrt{\frac{S_1^2}{n_1}+\frac{S_2^2}{n_2}}$ 
			- 분산이 다르다고 가정할 시 합동 분산 추정량(pooled variance estimator) 공식을 사용하여 SE 공식 대입.
				- $S_p^2 = \dfrac{(n_1-1)s_1^2+(n_2-1)s_2^2}{n_1+n_2-2}$
				- $SE(\overline{x}_1-\overline{x}_1) = \sqrt{\frac{S_p^2}{n_1}+\frac{S_p^2}{n_2}}$ 
				- ⇒ 2042
		- CI 구간을 구한다.
			- $C.I = \overline{X_1}-\overline{X_2}\pm t(\frac{a}{2},df)SE$
			- (957, 9543)
		- $\therefore$ 95% 신뢰도로 957~9,543의 임금격차가 있다.
- 참고
	- 엑셀에서 통계 패키지를 통해 describe를 계산한다. 평균과 신뢰수준을 +-하면 상한, 하한값을 구할 수 있다.